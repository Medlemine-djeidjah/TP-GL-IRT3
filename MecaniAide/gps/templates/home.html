 {% extends "layout.html" %} 

 
 {% block content %}
 <div id="mapid" x-data="map()" x-init="initMap()" style="height: 100vh; width: 100vw;">
 </div>
 {% endblock content %}

 
 {% block scripts %}
 <script>
    function map (){
        const myMap = L.map("mapid", {
            center : [18.094516443901764, -15.977817993728276],
            zoom : 13, 
            layers : [
                L.tileLayer('https://maps.geoapify.com/v1/tile/dark-matter-yellow-roads/{z}/{x}/{y}.png?apiKey=a2faa87e609c42c6ada240cc5515642d', {
                    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
                }),
            ]
        })
        return {
            initMap (){
               myMap.fitWorld(); 
               myMap.locate({setView: true, maxZoom: 16}).on('locationfound', (e) => {
                // if the location is found 
                var radius = e.accuracy;
                
                L.marker(e.latlng).addTo(myMap)
                    .bindPopup("You are within " + radius + " meters from this point").openPopup();
            
                L.circle(e.latlng, radius).addTo(myMap);
                
                // if the location fetching failed 
            }).on("locationerror", (e) => {
                alert(e.message);
            });
            },
        }
    }
 </script>
 {% endblock scripts %}
